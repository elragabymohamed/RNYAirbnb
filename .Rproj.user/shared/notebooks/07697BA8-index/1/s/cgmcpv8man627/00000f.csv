"0","#Combining Map 1 & 2"
"0","library(sf)"
"0","library(leaflet)"
"0","library(leaflet.extras)"
"0",""
"0","setwd(""/Users/elragaby/Desktop/Data Science"")"
"0","coor <- st_read(""coord"")"
"1","Reading layer `"
"1","coord"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","/Users/elragaby/Desktop/Data Science/coord"
"1","' "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 310 features and 4 fields"
"1","
"
"1","Geometry type: POLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -74.25559 ymin: 40.49613 xmax: -73.70001 ymax: 40.91553"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","str(coor)"
"1","Classes"
"1"," "
"1","‘sf’"
"1"," "
"1","and "
"1","'data.frame':	"
"1",""
"1","310"
"1",""
"1"," obs. of  "
"1",""
"1","5"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","neighborhood"
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""Allerton"" ""Alley Pond Park"" ""Arden Heights"" ""Arlington"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","boroughCode "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""2"" ""4"" ""5"" ""5"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","borough     "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""Bronx"" ""Queens"" ""Staten Island"" ""Staten Island"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","X.id        "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""http://nyc.pediacities.com/Resource/Neighborhood/Allerton"" ""http://nyc.pediacities.com/Resource/Neighborhood/Alley_Pond_Park"" ""http://nyc.pediacities.com/Resource/Neighborhood/Arden_Heights"" ""http://nyc.pediacities.com/Resource/Neighborhood/Arlington"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","geometry    "
"1",""
"1",":"
"1","sfc_POLYGON of length 310"
"1","; first list element: "
"1","List"
"1",""
"1"," of "
"1",""
"1","1"
"1",""
"1","
"
"1","  .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," num [1:16, 1:2] "
"1",""
"1","-73.8 -73.8 -73.9 -73.9 -73.9"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""class"")="
"1"," chr [1:3] "
"1",""
"1","""XY"" ""POLYGON"" ""sfg"""
"1",""
"1","
"
"1"," "
"1",""
"1","- attr(*, ""sf_column"")="
"1"," chr "
"1",""
"1","""geometry"""
"1",""
"1","
"
"1"," "
"1",""
"1","- attr(*, ""agr"")="
"1"," Factor w/ 3 levels ""constant"",""aggregate"",..: "
"1",""
"1","NA NA NA NA"
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:4] "
"1",""
"1","""neighborhood"" ""boroughCode"" ""borough"" ""X.id"""
"1",""
"1","
"
"0","ny_airbnb <- read.csv(""NY2024.csv"")"
"0",""
"0","# Calculating average price by neighborhood"
"0","feq <- aggregate(ny_airbnb$price, by = list(ny_airbnb$neighborhood), FUN = mean)"
"0","names(feq) <- c('neighborhood', 'average_price')"
"0",""
"0","# Merging 'coor' and 'feq' data frames on 'neighborhood'"
"0","coor <- merge(coor, feq, by='neighborhood', all.x=TRUE)"
"0",""
"0","# Rounding 'average_price' to the nearest integer"
"0","coor$average_price <- round(coor$average_price)"
"0",""
"0","color_scale <- colorNumeric(palette= ""Purples"", domain = NULL)"
"0",""
"0","# Creating a leaflet map"
"0","map <- leaflet(coor) %>%"
"0","  setView(lng = -74.00, lat = 40.71, zoom = 10) %>%"
"0","  addProviderTiles(""CartoDB.Positron"") %>%"
"0","  addPolygons("
"0","    fillColor = ~color_scale(average_price),"
"0","    weight = 1,"
"0","    color = ""black"","
"0","    fillOpacity = 0.5,"
"0","    highlight = highlightOptions("
"0","      weight = 3,"
"0","      fillColor = ~color_scale(average_price),"
"0","      fillOpacity = 0.8"
"0","    ),"
"0","    #label = ~paste(neighborhood, ': ',"" $"",average_price, ""/ night"")"
"0","  ) %>%"
"0","  addLegend("
"0","    position = ""bottomright"","
"0","    pal = color_scale,"
"0","    values = coor$average_price,"
"0","    title = ""Average Price"","
"0","    opacity = 0.7"
"0","  )"
"0",""
"0","# Creating a simple spatial object"
"0","NYData_sf <- st_as_sf(NYData, coords = c(""longitude"", ""latitude""), crs = 4326)"
"0",""
"0","colors_red <- colorNumeric(palette = ""Reds"", domain = NULL)"
"0",""
"0","# Adding markers to the existing map"
"0","map <- addMarkers("
"0","  map,"
"0","  data = NYData_sf,"
"0","  clusterOptions = markerClusterOptions(),"
"0","  group = ""listings"","
"0","  options = markerOptions("
"0","    fillColor = ~colors_red(price),"
"0","    fillOpacity = 0.75,"
"0","    weight = 2,"
"0","    color = ""black"","
"0","    radius = 5"
"0","  ),"
"0","  popup = ~paste("
"0","    ""<strong>Price:</strong>"", price, ""<br>"","
"0","    ""<strong>Room Type:</strong>"", room_type, ""<br>"","
"0","    ""<strong>Minimum Nights:</strong>"", minimum_nights, ""<br>"","
"0","    ""<strong>Bedrooms:</strong>"", bedrooms, ""<br>"","
"0","    ""<strong>Beds:</strong>"", beds, ""<br>"","
"0","    ""<strong>Baths:</strong>"", baths"
"0","  )"
"0",") %>%"
"0","  addMiniMap(toggleDisplay = TRUE)"
"0","map"
